import{n as ie,r as le}from"./scheduler.DfWX43tP.js";import{S as re,i as ae,e as w,s as A,c as F,a as k,b as B,r as H,f as L,d as M,h as g,j as f,k as K,l as v,u as P,m as z,v as j,w as se,o as S,x as $,p as R,y as ee,q as G,t as te,g as ne}from"./index.yw1ujjTK.js";import{I as J,d as oe,i as ue,S as fe,K as ce,V as de,v as Q,w as W}from"./Spinner.DpnkzrsM.js";import{h as pe}from"./errors.DI1mLwO8.js";import{a as X}from"./index.BljgEkYd.js";import{t as Y}from"./notifications.DAgDia_a.js";import{i as me}from"./entry.PqAeg84Z.js";import{b as _e}from"./paths.BVXwFHBQ.js";function Z(l){let t,e,a,m,i=l[4]&&x();function r(s,h){return s[2]==null?ve:he}let u=r(l),d=u(l);return{c(){t=w("div"),e=w("button"),i&&i.c(),a=A(),d.c(),this.h()},l(s){t=k(s,"DIV",{class:!0});var h=B(t);e=k(h,"BUTTON",{type:!0,class:!0});var c=B(e);i&&i.l(c),a=L(c),d.l(c),c.forEach(g),h.forEach(g),this.h()},h(){f(e,"type","submit"),f(e,"class","btn primary flex flex-shrink"),e.disabled=l[8],f(t,"class","flex flex-row justify-end")},m(s,h){K(s,t,h),v(t,e),i&&i.m(e,null),v(e,a),d.m(e,null),m=!0},p(s,h){s[4]?i?h&16&&S(i,1):(i=x(),i.c(),S(i,1),i.m(e,a)):i&&($(),R(i,1,1,()=>{i=null}),ee()),u!==(u=r(s))&&(d.d(1),d=u(s),d&&(d.c(),d.m(e,null))),(!m||h&256)&&(e.disabled=s[8])},i(s){m||(S(i),m=!0)},o(s){R(i),m=!1},d(s){s&&g(t),i&&i.d(),d.d()}}}function x(l){let t,e,a,m;return a=new fe({}),{c(){t=w("div"),e=w("div"),F(a.$$.fragment),this.h()},l(i){t=k(i,"DIV",{class:!0});var r=B(t);e=k(r,"DIV",{class:!0});var u=B(e);M(a.$$.fragment,u),u.forEach(g),r.forEach(g),this.h()},h(){f(e,"class","inline-block w-6 h-6"),f(t,"class","flex flex-row justify-center mr-2")},m(i,r){K(i,t,r),v(t,e),z(a,e,null),m=!0},i(i){m||(S(a.$$.fragment,i),m=!0)},o(i){R(a.$$.fragment,i),m=!1},d(i){i&&g(t),G(a)}}}function he(l){let t;return{c(){t=te("Update")},l(e){t=ne(e,"Update")},m(e,a){K(e,t,a)},d(e){e&&g(t)}}}function ve(l){let t;return{c(){t=te("Create")},l(e){t=ne(e,"Create")},m(e,a){K(e,t,a)},d(e){e&&g(t)}}}function be(l){let t,e,a,m="Description",i,r,u,d,s,h,c,b,E="URL Safe Short Name",N,_,V,T,y,I,U,q,O;s=new J({props:{name:"description",result:l[3]}}),y=new J({props:{name:"uri",result:l[3]}});let n=(l[5]!==l[0]||l[6]!==l[1])&&Z(l);return{c(){t=w("form"),e=w("div"),a=w("label"),a.textContent=m,i=A(),r=w("input"),d=A(),F(s.$$.fragment),h=A(),c=w("div"),b=w("label"),b.textContent=E,N=A(),_=w("input"),T=A(),F(y.$$.fragment),I=A(),n&&n.c(),this.h()},l(o){t=k(o,"FORM",{class:!0});var p=B(t);e=k(p,"DIV",{class:!0});var C=B(e);a=k(C,"LABEL",{for:!0,"data-svelte-h":!0}),H(a)!=="svelte-x0kogn"&&(a.textContent=m),i=L(C),r=k(C,"INPUT",{id:!0,class:!0,type:!0,name:!0,placeholder:!0}),d=L(C),M(s.$$.fragment,C),C.forEach(g),h=L(p),c=k(p,"DIV",{class:!0});var D=B(c);b=k(D,"LABEL",{for:!0,"data-svelte-h":!0}),H(b)!=="svelte-10oskxe"&&(b.textContent=E),N=L(D),_=k(D,"INPUT",{id:!0,class:!0,type:!0,name:!0,placeholder:!0}),T=L(D),M(y.$$.fragment,D),D.forEach(g),I=L(p),n&&n.l(p),p.forEach(g),this.h()},h(){f(a,"for","application-description"),f(r,"id","application-description"),f(r,"class",u="w-full "+l[7]("description")),f(r,"type","text"),f(r,"name","description"),f(r,"placeholder","Description"),f(e,"class","mb-2"),f(b,"for","application-uri"),f(_,"id","application-uri"),f(_,"class",V="w-full "+l[7]("uri")),f(_,"type","text"),f(_,"name","uri"),f(_,"placeholder","URL Safe Short Name"),f(c,"class","mb-2"),f(t,"class","flex flex-col flex-grow")},m(o,p){K(o,t,p),v(t,e),v(e,a),v(e,i),v(e,r),P(r,l[0]),v(e,d),z(s,e,null),v(t,h),v(t,c),v(c,b),v(c,N),v(c,_),P(_,l[1]),v(c,T),z(y,c,null),v(t,I),n&&n.m(t,null),U=!0,q||(O=[j(r,"input",l[13]),j(r,"input",l[9]),j(_,"input",l[14]),j(_,"input",l[10]),j(t,"submit",se(l[11]))],q=!0)},p(o,[p]){(!U||p&128&&u!==(u="w-full "+o[7]("description")))&&f(r,"class",u),p&1&&r.value!==o[0]&&P(r,o[0]);const C={};p&8&&(C.result=o[3]),s.$set(C),(!U||p&128&&V!==(V="w-full "+o[7]("uri")))&&f(_,"class",V),p&2&&_.value!==o[1]&&P(_,o[1]);const D={};p&8&&(D.result=o[3]),y.$set(D),o[5]!==o[0]||o[6]!==o[1]?n?(n.p(o,p),p&99&&S(n,1)):(n=Z(o),n.c(),S(n,1),n.m(t,null)):n&&($(),R(n,1,1,()=>{n=null}),ee())},i(o){U||(S(s.$$.fragment,o),S(y.$$.fragment,o),S(n),U=!0)},o(o){R(s.$$.fragment,o),R(y.$$.fragment,o),R(n),U=!1},d(o){o&&g(t),G(s),G(y),n&&n.d(),q=!1,le(O)}}}const ge=()=>ce((l={},t)=>{t.length&&(de(t),Q("description","required",()=>{W(l.description).isNotBlank()}),Q("uri","required",()=>{W(l.uri).isNotBlank()}))});function we(l,t,e){let a,m,{id:i=void 0}=t,{description:r=""}=t,{uri:u=""}=t,{onDone:d}=t;const s=ge();let h=r,c=u,b=s.get();const E=new Set,N=oe(()=>{s({description:r,uri:u},Array.from(E)).done(n=>{e(3,b=n)}),E.clear()},300);function _(){E.add("description"),E.add("uri"),N(),N.flush()}function V(n){E.add(n.currentTarget.name),N()}function T(n){e(1,u=Y(r)),V(n)}function y(n){e(1,u=Y(u)),V(n)}let I=!1;async function U(){try{if(e(4,I=!0),_(),b.isValid()){const n=i==null?await X.create({description:r,uri:u}):await X.update(i,{description:r,uri:u});i==null&&await me(`${_e}/applications`),e(5,h=n.description),e(6,c=n.uri),d(n),s.reset()}}catch(n){await pe(n)}finally{e(4,I=!1)}}function q(){r=this.value,e(0,r)}function O(){u=this.value,e(1,u)}return l.$$set=n=>{"id"in n&&e(2,i=n.id),"description"in n&&e(0,r=n.description),"uri"in n&&e(1,u=n.uri),"onDone"in n&&e(12,d=n.onDone)},l.$$.update=()=>{l.$$.dirty&16&&e(8,a=I),l.$$.dirty&8&&e(7,m=ue(b,{untested:"untested",tested:"tested",invalid:"invalid",valid:"valid",warning:"warning"}))},[r,u,i,b,I,h,c,m,a,T,y,U,d,q,O]}class Ne extends re{constructor(t){super(),ae(this,t,we,be,ie,{id:2,description:0,uri:1,onDone:12})}}export{Ne as A};
